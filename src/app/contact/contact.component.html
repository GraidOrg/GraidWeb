<div class="contact-container">
  <div class="contact-content" role="region" aria-labelledby="contact-title">
    <h1 id="contact-title" class="contact-title">{{ formTitle }}</h1>
    <p class="contact-subtitle">{{ formSubtitle }}</p>

    <form
      [formGroup]="contactForm"
      (ngSubmit)="onSubmit()"
      class="contact-form"
      novalidate
      aria-label="Contact form"
    >
      <!-- Name Field -->
      <mat-form-field appearance="outline" class="form-field">
        <mat-label>Name</mat-label>
        <input
          matInput
          formControlName="name"
          required
          aria-required="true"
          autocomplete="name"
        />
        <mat-error *ngIf="isFieldInvalid('name')">
          {{ getErrorMessage("name") }}
        </mat-error>
      </mat-form-field>

      <!-- Email Field -->
      <mat-form-field appearance="outline" class="form-field">
        <mat-label>Email</mat-label>
        <input
          matInput
          type="email"
          formControlName="email"
          required
          aria-required="true"
          autocomplete="email"
        />
        <mat-error *ngIf="isFieldInvalid('email')">
          {{ getErrorMessage("email") }}
        </mat-error>
      </mat-form-field>

      <!-- Demo-specific fields -->
      <ng-container *ngIf="formType === constants.FORM_TYPES.DEMO">
        <!-- Institution Field -->
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Institution/Organization</mat-label>
          <input
            matInput
            formControlName="institution"
            required
            aria-required="true"
            autocomplete="organization"
          />
          <mat-error *ngIf="isFieldInvalid('institution')">
            {{ getErrorMessage("institution") }}
          </mat-error>
        </mat-form-field>

        <!-- Role Field -->
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Role</mat-label>
          <mat-select formControlName="role" required>
            <mat-option value="Professor">Professor</mat-option>
            <mat-option value="Administrator">Administrator</mat-option>
            <mat-option value="Other">Other</mat-option>
          </mat-select>
          <mat-error *ngIf="isFieldInvalid('role')">
            {{ getErrorMessage("role") }}
          </mat-error>
        </mat-form-field>

        <!-- Preferred Date Field -->
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Preferred Date</mat-label>
          <input matInput [matDatepicker]="picker" formControlName="preferredDate" />
          <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>

        <!-- Preferred Time Field -->
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Preferred Time</mat-label>
          <input matInput type="time" formControlName="preferredTime" />
        </mat-form-field>
      </ng-container>

      <!-- Contact-specific fields -->
      <ng-container *ngIf="formType === constants.FORM_TYPES.CONTACT">
        <!-- Subject Field -->
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Subject</mat-label>
          <input
            matInput
            formControlName="subject"
            required
            aria-required="true"
          />
          <mat-error *ngIf="isFieldInvalid('subject')">
            {{ getErrorMessage("subject") }}
          </mat-error>
        </mat-form-field>
      </ng-container>

      <!-- Message Field -->
      <mat-form-field appearance="outline" class="form-field message-field">
        <mat-label>Message</mat-label>
        <textarea
          matInput
          formControlName="message"
          rows="5"
          [required]="formType === constants.FORM_TYPES.CONTACT"
          [attr.aria-required]="formType === constants.FORM_TYPES.CONTACT"
        ></textarea>
        <mat-error *ngIf="isFieldInvalid('message')">
          {{ getErrorMessage("message") }}
        </mat-error>
      </mat-form-field>

      <!-- Success Message -->
      <div
        *ngIf="submitSuccess"
        class="success-message"
        role="alert"
        aria-live="polite"
      >
        <p>{{ constants.MESSAGES.FORM_SUBMIT_SUCCESS }}</p>
      </div>

      <!-- Error Message -->
      <div
        *ngIf="submitError"
        class="error-message"
        role="alert"
        aria-live="assertive"
      >
        <p><strong>{{ constants.MESSAGES.FORM_SUBMIT_ERROR }}</strong></p>
        <p *ngIf="errorMessage" style="margin-top: 8px; font-size: 0.9rem;">
          {{ errorMessage }}
        </p>
        <p *ngIf="!environment.production" style="margin-top: 8px; font-size: 0.85rem; opacity: 0.8;">
          Check the browser console for more details.
        </p>
      </div>

      <!-- Submit Button -->
      <button
        mat-raised-button
        color="primary"
        type="submit"
        class="submit-button"
        [disabled]="isSubmitting || contactForm.invalid"
        [attr.aria-busy]="isSubmitting"
      >
        {{ isSubmitting ? 'Sending...' : 'Submit' }}
      </button>
    </form>
  </div>
</div>

